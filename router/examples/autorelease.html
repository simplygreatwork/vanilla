
<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, minimum-scale=1.0">
		<link rel="stylesheet" type="text/css" href="./style/columns.css"/>
		<title>Router: register</title>
		<style>
			#state {
				border:0px solid black;
				outline:1px dotted #212121;
			}
		</style>
	</head>
	<body>
		<div class="modal container">
			<div class="container">
				<section class="content">
					<select id="state" multiple=true size=20>
						<option>#/begin</option>
						<option>#/1</option>
						<option>#/1/2</option>
						<option>#/1/2/3</option>
						<option>#/1/2/3/4</option>
						<option>#/end</option>
					</select>
				</section>
				<section class="void">
					<div class="container">
						<section class="content">
							<header class="header">Output</header>
							<section class="scroll" id="output">
							</section>
						</section>
						<section class="void"></section>
					</div>
				</section>
			</div>
		</div>	
		
		<script type="module">
			
			import { Router } from '../source/router.js'
			import { install as install_logging } from '../../logger/source/logging.js'
			
			class Example {
				
				constructor() {
					
					let router = new Router()
					install_logging('#output')
					this.prepare_inputs()
					this.watch(router)
				}
				
				prepare_inputs() {
					
					document.querySelector('#state').onchange = function(element) {
						window.location.hash = this.value
						return false
					}
				}
				
				watch(router) {
					
					this.one(router)
					router.enter('a', function() {
						console.log('enter a')
					})
					router.exit('a', function() {
						console.log('exit a')
					})
				}
				
				one(router) {
					
					let path = '1'
					return router.register(path, {
						enter: function() {
							console.log(`enter ${path}`)
							return this.two(router)
						}.bind(this),
						exit : function() {
							console.log(`exit ${path}`)
						}.bind(this)
					})
				}
				
				two(router) {
					
					let path = '1/2'
					return router.register(path, {
						enter: function() {
							console.log(`enter ${path}`)
							return this.three(router)
						}.bind(this),
						exit : function() {
							console.log(`exit ${path}`)
						}.bind(this)
					})
				}
				
				three(router) {
					
					let path = '1/2/3'
					return router.register(path, {
						enter: function() {
							console.log(`enter ${path}`)
							return this.four(router)
						}.bind(this),
						exit : function() {
							console.log(`exit ${path}`)
						}.bind(this)
					})
				}
				
				four(router) {
					
					let path = '1/2/3/4'
					return router.register(path, {
						enter: function() {
							console.log(`enter ${path}`)
						}.bind(this),
						exit : function() {
							console.log(`exit ${path}`)
						}.bind(this)
					})
				}
			}
			
			new Example()
			
		</script>
	</body>
</html>
